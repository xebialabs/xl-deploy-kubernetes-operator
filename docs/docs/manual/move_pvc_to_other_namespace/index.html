<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<title data-react-helmet="true">move_pvc_to_other_namespace | Deploy Kubernetes Operator</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://xebialabs.github.io/xl-deploy-kubernetes-operator/docs/manual/move_pvc_to_other_namespace"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="move_pvc_to_other_namespace | Deploy Kubernetes Operator"><meta data-react-helmet="true" name="description" content="This is internal documentation. This document can be used only if it was recommended by the Support Team."><meta data-react-helmet="true" property="og:description" content="This is internal documentation. This document can be used only if it was recommended by the Support Team."><link data-react-helmet="true" rel="shortcut icon" href="/xl-deploy-kubernetes-operator/img/digital_ai_deploy.svg"><link data-react-helmet="true" rel="canonical" href="https://xebialabs.github.io/xl-deploy-kubernetes-operator/docs/manual/move_pvc_to_other_namespace"><link data-react-helmet="true" rel="alternate" href="https://xebialabs.github.io/xl-deploy-kubernetes-operator/docs/manual/move_pvc_to_other_namespace" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://xebialabs.github.io/xl-deploy-kubernetes-operator/docs/manual/move_pvc_to_other_namespace" hreflang="x-default"><link rel="stylesheet" href="/xl-deploy-kubernetes-operator/assets/css/styles.22a8eaea.css">
<link rel="preload" href="/xl-deploy-kubernetes-operator/assets/js/runtime~main.52d18a38.js" as="script">
<link rel="preload" href="/xl-deploy-kubernetes-operator/assets/js/main.379efe97.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/xl-deploy-kubernetes-operator/"><div class="navbar__logo"><img src="/xl-deploy-kubernetes-operator/img/digital_ai_deploy.svg" alt="Deploy Kubernetes Operator Digital.ai" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/xl-deploy-kubernetes-operator/img/digital_ai_deploy.svg" alt="Deploy Kubernetes Operator Digital.ai" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">Deploy Kubernetes Operator</b></a><a class="navbar__item navbar__link navbar__link--active" href="/xl-deploy-kubernetes-operator/docs/intro">Tutorial</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/xebialabs/xl-deploy-kubernetes-operator" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">üåú</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">üåû</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-operator/docs/intro">intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Manual installation</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xl-deploy-kubernetes-operator/docs/manual/onprem">onprem</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xl-deploy-kubernetes-operator/docs/manual/openshift">openshift</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xl-deploy-kubernetes-operator/docs/manual/aws-eks">aws-eks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xl-deploy-kubernetes-operator/docs/manual/azure-aks">azure-aks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xl-deploy-kubernetes-operator/docs/manual/gcp-gke">gcp-gke</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xl-deploy-kubernetes-operator/docs/manual/setting-up-custom-namespace">setting-up-custom-namespace</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xl-deploy-kubernetes-operator/docs/manual/change-namespace-for-xld-10.3-with-parallel">change-namespace-for-xld-10.3-with-parallel</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xl-deploy-kubernetes-operator/docs/manual/change-namespace-for-xld-10.3-with-downtime">change-namespace-for-xld-10.3-with-downtime</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/xl-deploy-kubernetes-operator/docs/manual/move_pvc_to_other_namespace">move_pvc_to_other_namespace</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xl-deploy-kubernetes-operator/docs/manual/manual-upgrade-for-xld-10">manual-upgrade-for-xld-10</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>move_pvc_to_other_namespace</h1></header><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>This is internal documentation. This document can be used only if it was recommended by the Support Team.</p></div></div><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>This setup is deprecated from the 22.3 version.</p></div></div><header><h1>C. How to change namespace of the PVC</h1></header><h2 class="anchor anchorWithStickyNavbar_31ik" id="prerequisites">Prerequisites<a aria-hidden="true" class="hash-link" href="#prerequisites" title="Direct link to heading">‚Äã</a></h2><ul><li>The kubectl command-line tool</li><li>Access to a Kubernetes cluster with installed Deploy in the <code>default</code> namespace</li></ul><p>Tested with:</p><ul><li>xl-deploy 10.3.9</li><li>xl-cli 22.1.4</li><li>AWS EKS cluster</li></ul><h2 class="anchor anchorWithStickyNavbar_31ik" id="c1-backup-everything">C.1. Backup everything<a aria-hidden="true" class="hash-link" href="#c1-backup-everything" title="Direct link to heading">‚Äã</a></h2><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Before doing any of the following steps backup everything:</p><ul><li>database data</li><li>any custom configuration that was done for the operator setup<ul><li>StatefulSets</li><li>Deployments</li><li>ConfigMaps</li><li>Secrets</li><li>CustomResource</li><li>anything else that was customized</li></ul></li><li>any volume related to deploy master in the default namespace, for example data from the mounted volumes on the deploy master pod:<ul><li>/opt/xebialabs/xl-deploy-server/central-conf/deploy-server.yaml.template</li><li>/opt/xebialabs/xl-deploy-server/centralConfiguration/deploy-oidc.yaml  </li><li>/opt/xebialabs/xl-deploy-server/work</li><li>/opt/xebialabs/xl-deploy-server/conf</li><li>/opt/xebialabs/xl-deploy-server/centralConfiguration</li><li>/opt/xebialabs/xl-deploy-server/ext</li><li>/opt/xebialabs/xl-deploy-server/hotfix/lib</li><li>/opt/xebialabs/xl-deploy-server/hotfix/plugins</li><li>/opt/xebialabs/xl-deploy-server/hotfix/satellite-lib</li><li>/opt/xebialabs/xl-deploy-server/log</li></ul></li><li>any volume related to deploy worker in the default namespace, for example data from the mounted volumes on the deploy worker pod:<ul><li>/opt/xebialabs/xl-deploy-server/work</li><li>/opt/xebialabs/xl-deploy-server/conf</li><li>/opt/xebialabs/xl-deploy-server/centralConfiguration</li><li>/opt/xebialabs/xl-deploy-server/ext</li><li>/opt/xebialabs/xl-deploy-server/hotfix/lib</li><li>/opt/xebialabs/xl-deploy-server/hotfix/plugins</li><li>/opt/xebialabs/xl-deploy-server/hotfix/satellite-lib</li><li>/opt/xebialabs/xl-deploy-server/log</li></ul></li></ul></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="c2-be-sure-to-not-delete-pvs-with-your-actions">C.2. Be sure to not delete PVs with your actions<a aria-hidden="true" class="hash-link" href="#c2-be-sure-to-not-delete-pvs-with-your-actions" title="Direct link to heading">‚Äã</a></h2><p>Patch the all PVs to set the ‚ÄúpersistentVolumeReclaimPolicy‚Äù to ‚ÄúRetain‚Äù, for example (if cluster admin&#x27;s didn&#x27;t do that already):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl get pv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                                                STORAGECLASS          REASON   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvc-4fa67d64-8763-464f-890b-0ba4124a780c   8Gi        RWO            Delete           Bound    default/data-dai-xld-rabbitmq-0                      aws-efs-provisioner            29m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvc-5b6a8575-3017-43c1-92ab-41ee1e0fd3b1   10Gi       RWO            Delete           Bound    default/data-dir-dai-xld-digitalai-deploy-worker-0   aws-efs-provisioner            29m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvc-8055342d-51e2-4d3d-8066-f2efcb16f658   10Gi       RWO            Delete           Bound    default/data-dir-dai-xld-digitalai-deploy-master-0   aws-efs-provisioner            29m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvc-fe787f3c-3036-49fe-a0d9-6f09db5510f2   50Gi       RWO            Delete           Bound    default/data-dai-xld-postgresql-0                    aws-efs-provisioner            29m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl patch pv pvc-8055342d-51e2-4d3d-8066-f2efcb16f658 -p &#x27;{&quot;spec&quot;:{&quot;persistentVolumeReclaimPolicy&quot;:&quot;Retain&quot;}}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">persistentvolume/pvc-53564205-6e1e-45f0-9dcf-e21adefa6eaf patched</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Export the current PVCs objects because it will be necessary to recreate the PVCs in a later stage:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl get pvc data-dir-dai-xld-digitalai-deploy-master-0 -n default -o yaml &gt; pvc-data-dir-dai-xld-digitalai-deploy-master-0.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl get pvc data-dir-dai-xld-digitalai-deploy-worker-0 -n default -o yaml &gt; pvc-data-dir-dai-xld-digitalai-deploy-worker-0.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl get pvc data-dai-xld-postgresql-0 -n default -o yaml &gt; pvc-data-dai-xld-postgresql-0.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Iterate on all PVs that are connected to the XLD PVCs in the default namespace, list depends on the installed components.
For example, here is list of PVCs that are usually in the default namespace:</p><ul><li>data-dir-dai-xld-digitalai-deploy-master-0</li><li>data-dir-dai-xld-digitalai-deploy-worker-0  </li><li>data-dai-xld-postgresql-0</li><li>data-dai-xld-rabbitmq-0</li></ul><p>On the end check if all PVs have correct Reclaim Policy:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl get pv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                                                STORAGECLASS          REASON   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvc-4fa67d64-8763-464f-890b-0ba4124a780c   8Gi        RWO            Retain           Bound    default/data-dai-xld-rabbitmq-0                      aws-efs-provisioner            32m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvc-5b6a8575-3017-43c1-92ab-41ee1e0fd3b1   10Gi       RWO            Retain           Bound    default/data-dir-dai-xld-digitalai-deploy-worker-0   aws-efs-provisioner            32m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvc-8055342d-51e2-4d3d-8066-f2efcb16f658   10Gi       RWO            Retain           Bound    default/data-dir-dai-xld-digitalai-deploy-master-0   aws-efs-provisioner            32m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvc-fe787f3c-3036-49fe-a0d9-6f09db5510f2   50Gi       RWO            Retain           Bound    default/data-dai-xld-postgresql-0                    aws-efs-provisioner            32m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="c3-stop-everything-that-is-using-xld-pvc-s-and-other-pvc-if-needed">C.3. Stop everything that is using XLD PVC-s (and other PVC if needed)<a aria-hidden="true" class="hash-link" href="#c3-stop-everything-that-is-using-xld-pvc-s-and-other-pvc-if-needed" title="Direct link to heading">‚Äã</a></h2><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Be sure that you did backup of the CR before this step!</p></div></div><p>If you are sure that everything is backuped and ready for installation on the new custom namespace, you can destroy previous setup on the <code>default</code> namespace,
here are steps how to do that:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># get the CR on default namespace and delete it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl get digitalaideploys.xld.digital.ai -n default -o yaml </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cr-dai-xld-default.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl delete -n default -f cr-dai-xld-default.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># get the deployment on default namespace and delete it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl get deployment -n default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl delete -n default deployment xld-operator-controller-manager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># get the service on default namespace and delete it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl get </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> -n default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl delete -n default </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> xld-operator-controller-manager-metrics-service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># get the role on default namespace and delete it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl get roles -n default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl delete -n default roles xld-operator-leader-election-role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># get the roleBinding on default namespace and delete it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl get roleBinding -n default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl delete -n default roleBinding xld-operator-leader-election-rolebinding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># get clusterRoles related to XLD on default namespace and delete them</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl get clusterRoles</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl delete clusterRoles xld-operator-manager-role xld-operator-metrics-reader xld-operator-proxy-role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># get clusterRoleBinding related to XLD on default namespace and delete them</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl get clusterRoleBinding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl delete clusterRoleBinding xld-operator-proxy-rolebinding xld-operator-manager-rolebinding</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Do not delete PVs or PVCs we can reuse them on the new namespace.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="c4-move-existing-pvc-to-the-custom-namespace">C.4. Move existing PVC to the custom namespace<a aria-hidden="true" class="hash-link" href="#c4-move-existing-pvc-to-the-custom-namespace" title="Direct link to heading">‚Äã</a></h2><p>Select one option that the best suites for your case.</p><p>Iterate one of the selected options on all PVs and PVCs that are connected to the XLD PVCs in the default namespace, list depends on the installed components.
For example, here is list of PVCs that are usually in the default namespace:</p><ul><li>data-dir-dai-xld-digitalai-deploy-master-0 - recommended is option C.4.OPTION_1</li><li>data-dir-dai-xld-digitalai-deploy-worker-0 - recommended is option C.4.OPTION_1</li><li>data-dai-xld-postgresql-0 - if embedded DB is used the best is to use C.4.OPTION_2</li><li>data-dai-xld-rabbitmq-0 - if embedded rabbitmq is used you can skip rabbitmq PVC migration, rabbitmq in the new namespace will use new PVC and PV in that case. </li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="c4option_1-create-pvc-in-the-custom-namespace-by-copying-pv-data">C.4.OPTION_1 Create PVC in the custom namespace by copying PV data<a aria-hidden="true" class="hash-link" href="#c4option_1-create-pvc-in-the-custom-namespace-by-copying-pv-data" title="Direct link to heading">‚Äã</a></h3><h4 class="anchor anchorWithStickyNavbar_31ik" id="c4option_11-make-the-copy-of-the-pvc-data-dir-dai-xld-digitalai-deploy-master-0yaml-for-the-later-reference-to-the-pvc-data-dir-dai-xld-digitalai-deploy-master-0-nsxldyaml">C.4.OPTION_1.1 Make the copy of the <code>pvc-data-dir-dai-xld-digitalai-deploy-master-0.yaml</code> for the later reference, to the <code>pvc-data-dir-dai-xld-digitalai-deploy-master-0-nsxld.yaml</code>.<a aria-hidden="true" class="hash-link" href="#c4option_11-make-the-copy-of-the-pvc-data-dir-dai-xld-digitalai-deploy-master-0yaml-for-the-later-reference-to-the-pvc-data-dir-dai-xld-digitalai-deploy-master-0-nsxldyaml" title="Direct link to heading">‚Äã</a></h4><ul><li><p>Edit file <code>pvc-data-dir-dai-xld-digitalai-deploy-master-0-nsxld.yaml</code>:</p><ol><li>Delete all the lines under sections:</li></ol><ul><li><code>status</code></li><li><code>spec.volumneMode</code></li><li><code>spec.volumneName</code></li><li><code>metadata.uid</code></li><li><code>metadata.resourceVersion</code></li><li><code>metadata.namespace</code></li><li><code>metadata.creationTimestamp</code></li><li><code>metadata.finalizers</code></li><li><code>metadata.annotations.pv.kubernetes.io/bind-completed</code></li><li><code>metadata.annotations.pv.kubernetes.io/bound-by-controller</code></li></ul><ol start="2"><li>Rename following lines by adding namespace name:</li></ol><ul><li><code>metadata.name</code> from data-dir-dai-xld-digitalai-deploy-master-0 to data-dir-dai-xld-nsxld-digitalai-deploy-master-0</li><li><code>metadata.labels.release</code> from dai-xld to dai-xld-nsxld</li><li><code>metadata.annotations.meta.helm.sh/release-namespace</code> from default to nsxld</li><li><code>metadata.annotations.meta.helm.sh/release-name</code> from dai-xld to dai-xld-nsxld
The renaming rule is to replace any occurrence of <code>dai-xld</code> with <code>dai-xld-{{custom_namespace_name}}</code></li></ul></li><li><p>Create those PVCs, but inside the Namespace ‚Äúnsxld‚Äù:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl apply -f pvc-data-dir-dai-xld-digitalai-deploy-master-0-nsxld.yaml -n nsxld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">persistentvolumeclaim/dai-xld-nsxld-digitalai-deploy-master-0 created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl apply -f pvc-data-dir-dai-xld-digitalai-deploy-worker-0-nsxld.yaml -n nsxld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">persistentvolumeclaim/dai-xld-nsxld-digitalai-deploy-worker-0 created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><p>Check if PVC is bound
Check the PVCs state, which will probably in Pending state, and after some time in Bound state:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl get pvc -n nsxld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                      STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS          AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dai-xld-nsxld-digitalai-deploy-master-0   Bound    pvc-fba6fe7c-143e-4af8-b974-0e5ec06b3ea8   10Gi       RWO            aws-efs-provisioner   3m54s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dai-xld-nsxld-digitalai-deploy-worker-0   Bound    pvc-88fc1c15-dfab-4495-80df-9baed3af22de   10Gi       RWO            aws-efs-provisioner   28s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="c4option_12">C.4.OPTION_1.2<a aria-hidden="true" class="hash-link" href="#c4option_12" title="Direct link to heading">‚Äã</a></h4><h5 class="anchor anchorWithStickyNavbar_31ik" id="c4option_12-master---start-following-pods">C.4.OPTION_1.2 Master - Start following pods<a aria-hidden="true" class="hash-link" href="#c4option_12-master---start-following-pods" title="Direct link to heading">‚Äã</a></h5><ul><li><ol><li>Put following in file <code>pod-dai-xld-master-pv-access-nsxld.yaml</code> (don&#x27;t forget to update nsxld with real namespace name):<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">  ```yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  kind: Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: dai-xld-master-pv-access-nsxld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: sleeper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        command: [&quot;sleep&quot;, &quot;1d&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image: xebialabs/tiny-tools:22.2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        imagePullPolicy: Always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        volumeMounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - name: data-dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mountPath: /opt/xebialabs/xl-deploy-server/work</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            subPath: work</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - name: data-dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mountPath: /opt/xebialabs/xl-deploy-server/conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            subPath: conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - name: data-dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mountPath: /opt/xebialabs/xl-deploy-server/centralConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            subPath: centralConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - name: data-dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mountPath: /opt/xebialabs/xl-deploy-server/ext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            subPath: ext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - name: data-dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mountPath: /opt/xebialabs/xl-deploy-server/hotfix/lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            subPath: lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - name: data-dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mountPath: /opt/xebialabs/xl-deploy-server/hotfix/plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            subPath: plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - name: data-dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mountPath: /opt/xebialabs/xl-deploy-server/hotfix/satellite-lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            subPath: satellite-lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - name: data-dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mountPath: /opt/xebialabs/xl-deploy-server/log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            subPath: log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    restartPolicy: Never</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: reports-dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        persistentVolumeClaim:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          claimName: data-dir-dai-xld-nsxld-digitalai-deploy-master-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ```</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div>Update the claimName with correct name!</li></ol></li><li><ol start="2"><li>Start the pod<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl apply -f pod-dai-xld-master-pv-access-nsxld.yaml -n nsxld</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ol></li><li><ol start="3"><li>Put following in file <code>pod-dai-xld-master-pv-access-default.yaml</code> for the default namespace:</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dai</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xld</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">master</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pv</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">access</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sleeper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;sleep&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1d&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> xebialabs/tiny</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">tools</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">22.2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">imagePullPolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">volumeMounts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/work</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> work</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/centralConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> centralConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/ext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/hotfix/lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/hotfix/plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/hotfix/satellite</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> satellite</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">restartPolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Never</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">persistentVolumeClaim</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">claimName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dai</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xld</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">digitalai</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">master</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><ol start="4"><li>Start the pod</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl apply -f pod-dai-xld-master-pv-access-default.yaml -n default</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><ol start="5"><li>Copy data from one pod to </li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -n default dai-xld-master-pv-access-default -- </span><span class="token function" style="color:#d73a49">tar</span><span class="token plain"> cf - </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/xebialabs/xl-deploy-server/centralConfiguration </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/xebialabs/xl-deploy-server/conf </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/xebialabs/xl-deploy-server/ext </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/xebialabs/xl-deploy-server/log </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/xebialabs/xl-deploy-server/work </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/xebialabs/xl-deploy-server/hotfix/lib </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/xebialabs/xl-deploy-server/hotfix/plugins </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/xebialabs/xl-deploy-server/hotfix/satellite-lib </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -n nsxld -i dai-xld-master-pv-access-nsxld -- </span><span class="token function" style="color:#d73a49">tar</span><span class="token plain"> xvf - -C /    </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><ol start="6"><li>Chmod of the moved folder as below</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -n nsxld -i dai-xld-master-pv-access-nsxld -- </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -R </span><span class="token number" style="color:#36acaa">777</span><span class="token plain"> /opt/xebialabs/xl-deploy-server/centralConfiguration/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -n nsxld -i dai-xld-master-pv-access-nsxld -- </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -R </span><span class="token number" style="color:#36acaa">777</span><span class="token plain"> /opt/xebialabs/xl-deploy-server/conf/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -n nsxld -i dai-xld-master-pv-access-nsxld -- </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -R </span><span class="token number" style="color:#36acaa">777</span><span class="token plain"> /opt/xebialabs/xl-deploy-server/ext/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -n nsxld -i dai-xld-master-pv-access-nsxld -- </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -R </span><span class="token number" style="color:#36acaa">777</span><span class="token plain"> /opt/xebialabs/xl-deploy-server/log/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -n nsxld -i dai-xld-master-pv-access-nsxld -- </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -R </span><span class="token number" style="color:#36acaa">777</span><span class="token plain"> /opt/xebialabs/xl-deploy-server/work/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -n nsxld -i dai-xld-master-pv-access-nsxld -- </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -R </span><span class="token number" style="color:#36acaa">777</span><span class="token plain"> /opt/xebialabs/xl-deploy-server/hotfix/lib/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -n nsxld -i dai-xld-master-pv-access-nsxld -- </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -R </span><span class="token number" style="color:#36acaa">777</span><span class="token plain"> /opt/xebialabs/xl-deploy-server/hotfix/plugins/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -n nsxld -i dai-xld-master-pv-access-nsxld -- </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -R </span><span class="token number" style="color:#36acaa">777</span><span class="token plain"> /opt/xebialabs/xl-deploy-server/hotfix/satellite-lib/</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><ol start="7"><li>Delete the pods</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl delete pod dai-xld-master-pv-access-nsxld -n nsxld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl delete pod dai-xld-master-pv-access-default -n default</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ul><h5 class="anchor anchorWithStickyNavbar_31ik" id="c4option_12-worker---start-following-pods">C.4.OPTION_1.2 Worker - Start following pods<a aria-hidden="true" class="hash-link" href="#c4option_12-worker---start-following-pods" title="Direct link to heading">‚Äã</a></h5><ul><li><ol><li>Put following in file <code>pod-dai-xld-worker-pv-access-nsxld.yaml</code> (don&#x27;t forget to update nsxld with real namespace name):</li></ol><ul><li>If version below 22.0.<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dai</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xld</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">worker</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pv</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">access</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">nsxld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sleeper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;sleep&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1d&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> xebialabs/tiny</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">tools</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">22.2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">imagePullPolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">volumeMounts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/work</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> work</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/centralConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> centralConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/ext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/hotfix/lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/hotfix/plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/hotfix/satellite</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> satellite</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">restartPolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Never</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> reports</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">persistentVolumeClaim</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">claimName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dai</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xld</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">nsxld</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">digitalai</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">worker</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ul></li><li><p>If xl-deploy version above 22.0</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dai</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xld</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">worker</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pv</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">access</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">nsxld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sleeper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;sleep&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1d&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> xebialabs/tiny</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">tools</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">22.2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">imagePullPolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">volumeMounts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">task</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">engine/work</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> work</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">task</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">engine/conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">task</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">engine/centralConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> centralConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">task</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">engine/ext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">task</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">engine/hotfix/lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">task</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">engine/hotfix/plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">task</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">engine/hotfix/satellite</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> satellite</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">task</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">engine/log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">restartPolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Never</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> reports</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">persistentVolumeClaim</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">claimName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dai</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xld</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">nsxld</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">digitalai</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">worker</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p> Update the claimName with correct name!</p></li><li><ol start="2"><li>Start the pod<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl apply -f pod-dai-xld-worker-pv-access-nsxld.yaml -n nsxld</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ol></li><li><ol start="3"><li>Put following in file <code>pod-dai-xld-worker-pv-access-default.yaml</code> for the default namespace:<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dai</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xld</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">worker</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pv</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">access</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sleeper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;sleep&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1d&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> xebialabs/tiny</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">tools</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">22.2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">imagePullPolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">volumeMounts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/work</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> work</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/centralConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> centralConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/ext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/hotfix/lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/hotfix/plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/hotfix/satellite</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> satellite</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/xebialabs/xl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server/log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">subPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">restartPolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Never</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">persistentVolumeClaim</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">claimName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dai</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xld</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">digitalai</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">worker</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ol></li><li><ol start="4"><li>Start the pod<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl apply -f pod-dai-xld-worker-pv-access-default.yaml -n default</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ol></li><li><ol start="5"><li>Copy data from one pod.</li></ol><ul><li><p>If the xl-deploy version is below 22.0</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -n default dai-xld-worker-pv-access-default -- </span><span class="token function" style="color:#d73a49">tar</span><span class="token plain"> cf - </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/xebialabs/xl-deploy-server/centralConfiguration </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/xebialabs/xl-deploy-server/conf </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/xebialabs/xl-deploy-server/ext </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/xebialabs/xl-deploy-server/log </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/xebialabs/xl-deploy-server/work </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/xebialabs/xl-deploy-server/hotfix/lib </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/xebialabs/xl-deploy-server/hotfix/plugins </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/xebialabs/xl-deploy-server/hotfix/satellite-lib </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -n nsxld -i dai-xld-worker-pv-access-nsxld -- </span><span class="token function" style="color:#d73a49">tar</span><span class="token plain"> xvf - -C /</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><p>If xl-deploy version is above 22.0, copy the file to local directory from pod <!-- -->[dai-xld-worker-pv-access-default]<!-- --> and copy the same file from local directory to pod <!-- -->[dai-xld-worker-pv-access-nsxld]</p><ul><li>Copying the centralConfiguration folder from dai-xld-worker-pv-access-default pod to local directory. <div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl </span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> -n default dai-xld-digitalai-deploy-worker-0:/opt/xebialabs/xl-deploy-server/centralConfiguration /home/sishwarya/SprintTicket/S-84982_ns_xld_migration/B-defaultns-downtime/pv_backup/option1-deploy/nsxld/data/centralConfiguration</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li>Copying the centralConfiguration folder from local directory to pod dai-xld-worker-pv-access-nsxld.<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl </span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> /home/sishwarya/SprintTicket/S-84982_ns_xld_migration/B-defaultns-downtime/pv_backup/option1-deploy/nsxld/data/work -n nsxld dai-xld-worker-pv-access-nsxld:/opt/xebialabs/deploy-task-engine/</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ul><p>Do the above steps for all directory which we need to migrate. eg: ext, log, work, etc.</p></li></ul></li><li><ol start="6"><li>Chmod of the moved folder<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -n nsxld -i dai-xld-worker-pv-access-nsxld -- </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -R </span><span class="token number" style="color:#36acaa">777</span><span class="token plain"> /opt/xebialabs/xl-deploy-server/work/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -n nsxld -i dai-xld-worker-pv-access-nsxld -- </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -R </span><span class="token number" style="color:#36acaa">777</span><span class="token plain"> /opt/xebialabs/xl-deploy-server/conf/</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ol></li><li><ol start="7"><li>Delete the pods</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl delete pod dai-xld-worker-pv-access-nsxld -n nsxld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl delete pod dai-xld-worker-pv-access-default -n default</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="c4option_2-move-existing-pvc-to-the-custom-namespace-by-reusing-pv">C.4.OPTION_2 Move existing PVC to the custom namespace by reusing PV<a aria-hidden="true" class="hash-link" href="#c4option_2-move-existing-pvc-to-the-custom-namespace-by-reusing-pv" title="Direct link to heading">‚Äã</a></h3><p>Following option will reuse PV in the new namespace, rollback of the option is more complicated. </p><ul><li><ol><li>Delete all the current PVCs in the namespace <code>default</code></li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl delete pvc data-dir-dai-xld-digitalai-deploy-master-0 -n default</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><ol start="2"><li>See that the related PV Status will be changed from <code>Bound</code> to <code>Released</code>:</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl get pv pvc-1df72d76-7970-43fa-b30f-77b6a0d07239 pvc-3f4052d9-a614-4d0f-a886-a5699dac4d5e -n default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS     CLAIM                                                STORAGECLASS          REASON   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvc-1df72d76-7970-43fa-b30f-77b6a0d07239   10Gi       RWO            Retain           Released   default/data-dir-dai-xld-digitalai-deploy-master-0   aws-efs-provisioner            5h55m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvc-3f4052d9-a614-4d0f-a886-a5699dac4d5e   10Gi       RWO            Retain           Released   default/data-dir-dai-xld-digitalai-deploy-worker-0   aws-efs-provisioner            5h55m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><ol start="3"><li>Edit each one of the PVs to remove the old references with claim:</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl edit pv pvc-1df72d76-7970-43fa-b30f-77b6a0d07239</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Remove lines like following example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">claimRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> PersistentVolumeClaim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dai</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xld</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">digitalai</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">master</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">resourceVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;23284462&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">uid</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 53564205</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">6e1e</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">45f0</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">9dcf</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">e21adefa6eaf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">claimRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> PersistentVolumeClaim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dir</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dai</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xld</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">digitalai</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">worker</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resourceVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;34085986&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">uid</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> c7a3176c</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">9721</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">472b</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">94a3</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dd5132a550a1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><ol start="4"><li>Check that there are no references anymore in the CLAIM column:</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl get pv pvc-1df72d76-7970-43fa-b30f-77b6a0d07239 pvc-3f4052d9-a614-4d0f-a886-a5699dac4d5e -n default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS      CLAIM   STORAGECLASS          REASON   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvc-1df72d76-7970-43fa-b30f-77b6a0d07239   10Gi       RWO            Retain           Available           aws-efs-provisioner            5h58m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvc-3f4052d9-a614-4d0f-a886-a5699dac4d5e   10Gi       RWO            Retain           Available           aws-efs-provisioner            5h58m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="c4option_21-make-the-copy-of-the-pvc-data-dir-dai-xld-digitalai-deploy-master-0yaml-for-the-later-reference-to-the-pvc-data-dir-dai-xld-digitalai-deploy-master-0-nsxldyaml">C.4.OPTION_2.1 Make the copy of the <code>pvc-data-dir-dai-xld-digitalai-deploy-master-0.yaml</code> for the later reference, to the <code>pvc-data-dir-dai-xld-digitalai-deploy-master-0-nsxld.yaml</code>.<a aria-hidden="true" class="hash-link" href="#c4option_21-make-the-copy-of-the-pvc-data-dir-dai-xld-digitalai-deploy-master-0yaml-for-the-later-reference-to-the-pvc-data-dir-dai-xld-digitalai-deploy-master-0-nsxldyaml" title="Direct link to heading">‚Äã</a></h4><ul><li><ol><li>Edit file <code>pvc-data-dir-dai-xld-digitalai-deploy-master-0-nsxld.yaml</code>:</li></ol><ul><li><ol><li>Delete all the lines under sections:</li></ol><ul><li><code>status</code></li><li><code>spec.volumneMode</code></li><li><code>spec.volumneName</code></li><li><code>metadata.uid</code></li><li><code>metadata.resourceVersion</code></li><li><code>metadata.namespace</code></li><li><code>metadata.creationTimestamp</code></li><li><code>metadata.finalizers</code></li><li><code>metadata.annotations.pv.kubernetes.io/bind-completed</code></li><li><code>metadata.annotations.pv.kubernetes.io/bound-by-controller</code></li></ul></li><li><ol start="2"><li>Rename following lines by adding namespace name:</li></ol><ul><li><code>metadata.name</code> from data-dir-dai-xld-digitalai-deploy-master-0 to data-dir-dai-xld-nsxld-digitalai-deploy-master-0</li><li><code>metadata.labels.release</code> from dai-xld to dai-xld-nsxld</li><li><code>metadata.annotations.meta.helm.sh/release-namespace</code> from default to nsxld</li><li><code>metadata.annotations.meta.helm.sh/release-name</code> from dai-xld to dai-xld-nsxld
The renaming rule is to replace any occurrence of <code>dai-xld</code> with <code>dai-xld-{{custom_namespace_name}}</code></li></ul></li></ul><p>Similarly do the above steps for other PVs <!-- -->[eg: Worker, postgresql ]</p></li><li><ol start="2"><li>Create those PVCs again, but inside the Namespace ‚Äúnsxld‚Äù:<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl apply -f pvc-data-dir-dai-xld-digitalai-deploy-master-0-nsxld.yaml -n nsxld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">persistentvolumeclaim/data-dir-dai-xld-nsxld-digitalai-deploy-master-0 created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl apply -f pvc-data-dir-dai-xld-digitalai-deploy-worker-0-nsxld.yaml -n nsxld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">persistentvolumeclaim/data-dir-dai-xld-nsxld-digitalai-deploy-worker-0 created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl apply -f pvc-data-dai-xld-postgresql-0-nsxld.yaml -n nsxld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">persistentvolumeclaim/data-dai-xld-nsxld-postgresql-0 created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ol></li><li><ol start="3"><li>Check the PVCs state, which will probably in Pending state, and after some time in Bound state:<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">‚ùØ kubectl get pv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                                                    STORAGECLASS          REASON   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvc-1df72d76-7970-43fa-b30f-77b6a0d07239   10Gi       RWO            Retain           Bound    nsxld/data-dir-dai-xld-nsxld-digitalai-deploy-worker-0   aws-efs-provisioner            6h39m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvc-2ccabe5e-c540-42c4-92c9-08bbac24e306   50Gi       RWO            Retain           Bound    nsxld/data-dai-xld-nsxld-postgresql-0                    aws-efs-provisioner            6h39m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvc-3f4052d9-a614-4d0f-a886-a5699dac4d5e   10Gi       RWO            Retain           Bound    nsxld/data-dir-dai-xld-nsxld-digitalai-deploy-master-0   aws-efs-provisioner            6h39m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ol></li><li><ol start="4"><li>On the moved PV for the deploy, if you need to modify, delete or empty some folders, do that with following.</li></ol><ul><li>Create the master pod in custom namespace <!-- -->[eg: nsxdd]<!-- -->, Similar to step C.4.OPTION_1.2 Master - Start following pods.<ul><li>Connect to the master pod<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain"> ‚ùØ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -it dai-xld-master-pv-access-nsxld -- </span><span class="token function" style="color:#d73a49">sh</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li>Remove/Update the file if required.</li></ul></li><li>Delete the master pod.</li></ul><p>Similarly do it for worker if required.
</p></li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="c4option_3-clone-existing-pvc-to-the-custom-namespace-by-csi-volume-cloning">C.4.OPTION_3 Clone existing PVC to the custom namespace by CSI Volume Cloning<a aria-hidden="true" class="hash-link" href="#c4option_3-clone-existing-pvc-to-the-custom-namespace-by-csi-volume-cloning" title="Direct link to heading">‚Äã</a></h3><p>Please check following document if this option is possible for your Persisted Volume setup (there are some limitations when it is possible):</p><p><a href="https://kubernetes.io/docs/concepts/storage/volume-pvc-datasource/" target="_blank" rel="noopener noreferrer">CSI Volume Cloning</a></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/xl-deploy-kubernetes-operator/docs/manual/change-namespace-for-xld-10.3-with-downtime"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ <!-- -->change-namespace-for-xld-10.3-with-downtime</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/xl-deploy-kubernetes-operator/docs/manual/manual-upgrade-for-xld-10"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">manual-upgrade-for-xld-10<!-- --> ¬ª</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#c1-backup-everything" class="table-of-contents__link toc-highlight">C.1. Backup everything</a></li><li><a href="#c2-be-sure-to-not-delete-pvs-with-your-actions" class="table-of-contents__link toc-highlight">C.2. Be sure to not delete PVs with your actions</a></li><li><a href="#c3-stop-everything-that-is-using-xld-pvc-s-and-other-pvc-if-needed" class="table-of-contents__link toc-highlight">C.3. Stop everything that is using XLD PVC-s (and other PVC if needed)</a></li><li><a href="#c4-move-existing-pvc-to-the-custom-namespace" class="table-of-contents__link toc-highlight">C.4. Move existing PVC to the custom namespace</a><ul><li><a href="#c4option_1-create-pvc-in-the-custom-namespace-by-copying-pv-data" class="table-of-contents__link toc-highlight">C.4.OPTION_1 Create PVC in the custom namespace by copying PV data</a></li><li><a href="#c4option_2-move-existing-pvc-to-the-custom-namespace-by-reusing-pv" class="table-of-contents__link toc-highlight">C.4.OPTION_2 Move existing PVC to the custom namespace by reusing PV</a></li><li><a href="#c4option_3-clone-existing-pvc-to-the-custom-namespace-by-csi-volume-cloning" class="table-of-contents__link toc-highlight">C.4.OPTION_3 Clone existing PVC to the custom namespace by CSI Volume Cloning</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/xl-deploy-kubernetes-operator/docs/intro">Tutorial</a></li><li class="footer__item"><a href="https://github.com/xebialabs/xl-deploy-kubernetes-operator" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2023 Deploy Kubernetes Operator Digital.ai</div></div></div></footer></div>
<script src="/xl-deploy-kubernetes-operator/assets/js/runtime~main.52d18a38.js"></script>
<script src="/xl-deploy-kubernetes-operator/assets/js/main.379efe97.js"></script>
</body>
</html>